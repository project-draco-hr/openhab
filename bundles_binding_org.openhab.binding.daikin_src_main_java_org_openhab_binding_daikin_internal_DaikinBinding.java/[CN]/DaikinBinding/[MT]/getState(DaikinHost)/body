{
  String url=String.format("http://%s/param.csv",host.getHost());
  CloseableHttpClient httpClient=HttpClients.custom().build();
  Map<DaikinCommandType,State> state=new HashMap<DaikinCommandType,State>();
  try {
    HttpGet httpGet=new HttpGet(url);
    CloseableHttpResponse httpResponse=httpClient.execute(httpGet);
    try {
      InputStream content=httpResponse.getEntity().getContent();
      BufferedReader reader=new BufferedReader(new InputStreamReader(content));
      List<String> results=new ArrayList<String>();
      String line;
      while ((line=reader.readLine()) != null) {
        if (line == null || line.length() == 0)         continue;
        results.add(line.substring(0,line.length() - 1));
      }
      if (!results.get(0).equals("OK")) {
        logger.error("Bad connection state received: {}",results.get(0));
      }
 else {
        state.put(DaikinCommandType.POWER,results.get(1).equals("ON") ? OnOffType.ON : OnOffType.OFF);
        state.put(DaikinCommandType.MODE,new StringType(results.get(2)));
        state.put(DaikinCommandType.TEMP,parseNumber(results.get(3)));
        state.put(DaikinCommandType.FAN,new StringType(results.get(4)));
        state.put(DaikinCommandType.SWING,new StringType(results.get(5)));
        state.put(DaikinCommandType.TEMPIN,parseNumber(results.get(6)));
        state.put(DaikinCommandType.TIMER,new StringType(results.get(7)));
        state.put(DaikinCommandType.TEMPOUT,parseNumber(results.get(14)));
        state.put(DaikinCommandType.HUMIDITYIN,parseNumber(results.get(15)));
      }
    }
  finally {
      httpResponse.close();
    }
  }
 catch (  ClientProtocolException e) {
    logger.error("Client protocol error attempting to request current state",e);
  }
catch (  IOException e) {
    logger.error("IO error attempting to request current state",e);
  }
  return state;
}
