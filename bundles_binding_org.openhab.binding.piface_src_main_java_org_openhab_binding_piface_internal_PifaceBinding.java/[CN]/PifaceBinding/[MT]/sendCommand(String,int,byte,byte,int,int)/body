{
  int attempt=1;
  while (attempt <= MAX_RETRIES) {
    byte response=sendCommand(host,port,command,commandAck,pinNumber,pinValue,attempt);
    if (response != ERROR_RESPONSE)     return response;
    logger.warn("Command failed, retrying...");
    attempt++;
  }
  logger.warn("Command failed " + MAX_RETRIES + " times. Stopping.");
  return ERROR_RESPONSE;
}
