{
  RrdDb rrdDb=new RrdDb(RRD_FOLDER + File.separator + itemName+ ".rrd");
  FetchRequest fetchRequest=rrdDb.createFetchRequest(consilidationFunction,Util.getTimestamp(timeBegin),Util.getTimestamp(timeEnd),resolution);
  FetchData fetchData=fetchRequest.fetchData();
  long[] timestamps=fetchData.getTimestamps();
  double[][] values=fetchData.getValues();
  logger.debug("RRD fetch returned '{}' rows and '{}' columns",fetchData.getRowCount(),fetchData.getColumnCount());
  for (int row=0; row < fetchData.getRowCount(); row++) {
    long time=timestamps[row] * 1000L;
    if (!data.containsKey(time)) {
      data.put(time,new ArrayList<String>());
    }
    ArrayList<String> vals=data.get(time);
    int indexOffset=vals.size();
    for (int dsIndex=0; dsIndex < fetchData.getColumnCount(); dsIndex++) {
      vals.add(dsIndex + indexOffset,formatDouble(values[dsIndex][row],"null",true));
    }
  }
  rrdDb.close();
  return data;
}
