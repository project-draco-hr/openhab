{
  long startTime=(new Date()).getTime();
  boolean timeout=false;
  BlockingStateChangeListener listener=new BlockingStateChangeListener();
  Set<GenericItem> items=getAllItems(widgets);
  for (  GenericItem item : items) {
    item.addStateChangeListener(listener);
  }
  do {
    timeout=(new Date()).getTime() - startTime > TIMEOUT_IN_MS;
    try {
      Thread.sleep(500);
    }
 catch (    InterruptedException e) {
      timeout=true;
      break;
    }
  }
 while (!listener.hasChangeOccurred() && !timeout);
  for (  GenericItem item : items) {
    item.removeStateChangeListener(listener);
  }
  return !timeout;
}
