{
  long startTime=(new Date()).getTime();
  BlockingStateChangeListener listener=new BlockingStateChangeListener();
  Set<GenericItem> items=getAllItems(widgets);
  for (  GenericItem item : items) {
    item.addStateChangeListener(listener);
  }
  while (!listener.hasChangeOccurred() && (new Date()).getTime() - startTime < 20000L) {
    try {
      Thread.sleep(300);
    }
 catch (    InterruptedException e) {
      break;
    }
  }
  for (  GenericItem item : items) {
    item.removeStateChangeListener(listener);
  }
}
