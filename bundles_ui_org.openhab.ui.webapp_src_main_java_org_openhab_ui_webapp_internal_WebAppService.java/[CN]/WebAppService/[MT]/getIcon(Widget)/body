{
  String widgetTypeName=w.eClass().getInstanceTypeName().substring(w.eClass().getInstanceTypeName().lastIndexOf(".") + 1);
  String icon=widgetTypeName.toLowerCase();
  if (w.getIcon() != null) {
    icon=w.getIcon();
  }
 else {
    String itemName=getItem(w);
    if (itemName != null && delegatingItemUIProvider != null) {
      String result=delegatingItemUIProvider.getIcon(itemName);
      if (result != null)       icon=result;
    }
  }
  if (!icon.contains("-")) {
    Object state=getState(w);
    if (!state.equals(UnDefType.UNDEF)) {
      icon+="-" + state.toString().toLowerCase();
    }
  }
  if (iconExists(icon) || !icon.contains("-")) {
    return icon;
  }
 else {
    return icon.substring(0,icon.indexOf("-"));
  }
}
