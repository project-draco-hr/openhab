{
  boolean debugging=false;
  Vector<String> retVal=new Vector<String>();
  byte[] responseBytes=new byte[32];
  String currResponse="";
  int numBytesReceived=0;
  int totBytesReceived=0;
  int i=0;
  int packetCounter=0;
  int headerSizeDecimal=0;
  int dataSizeDecimal=0;
  char endChar1='!';
  char endChar2='!';
  char endChar3='!';
  if (connected) {
    try {
      if (debugging) {
        logger.debug("\nReading Response Packet");
      }
      eiscpSocket.setSoTimeout(SOCKET_TIME_OUT);
      while ((numBytesReceived=inStream.read(responseBytes)) > 0) {
        totBytesReceived=0;
        StringBuilder msgBuffer=new StringBuilder("");
        if (debugging) {
          logger.debug("Packet [{}]:",packetCounter);
        }
        if (debugging) {
          System.out.print("" + numBytesReceived);
        }
        while (numBytesReceived > 0) {
          totBytesReceived+=numBytesReceived;
          msgBuffer.append(new String(responseBytes));
          responseBytes=new byte[32];
          numBytesReceived=0;
          if (inStream.available() > 0) {
            numBytesReceived=inStream.read(responseBytes);
          }
          if (debugging) {
            System.out.print(" " + numBytesReceived);
          }
        }
        if (debugging) {
          System.out.println();
        }
        convertStringToHex(msgBuffer.toString(),debugging);
        char[] responseChars=msgBuffer.toString().toCharArray();
        int responseByteCnt=0;
        char versionChar='1';
        char dataStartChar='!';
        char dataUnitChar='1';
        while (responseByteCnt < totBytesReceived) {
          responseByteCnt+=4;
          char[] headerSizeBytes={responseChars[responseByteCnt++],responseChars[responseByteCnt++],responseChars[responseByteCnt++],responseChars[responseByteCnt++]};
          char[] dataSizeBytes={responseChars[responseByteCnt++],responseChars[responseByteCnt++],responseChars[responseByteCnt++],responseChars[responseByteCnt++]};
          if (debugging) {
            System.out.println(" -HeaderSize-");
          }
          headerSizeDecimal=convertHexNumberStringToDecimal(new String(headerSizeBytes),debugging);
          if (debugging) {
            System.out.println(" -DataSize-");
          }
          dataSizeDecimal=convertHexNumberStringToDecimal(new String(dataSizeBytes),debugging);
          versionChar=responseChars[responseByteCnt++];
          responseByteCnt+=3;
          int dataByteCnt=0;
          dataStartChar=responseChars[responseByteCnt++];
          dataUnitChar=responseChars[responseByteCnt++];
          char[] dataMessage=new char[dataSizeDecimal];
          while (dataByteCnt < (dataSizeDecimal - 3) && responseByteCnt < (totBytesReceived - 3)) {
            dataMessage[dataByteCnt++]=responseChars[responseByteCnt++];
          }
          if (debugging) {
            System.out.println(" -DataMessage-");
          }
          if (debugging) {
            System.out.println("    " + (new String(dataMessage)) + "\n");
          }
          retVal.addElement(new String(dataMessage));
          endChar1=responseChars[responseByteCnt++];
          endChar2=responseChars[responseByteCnt++];
          endChar3=responseChars[responseByteCnt++];
          if (endChar1 == (char)Integer.parseInt("1A",16) && endChar2 == (char)Integer.parseInt("0D",16) && endChar3 == (char)Integer.parseInt("0A",16))           if (debugging) {
            System.out.println(" EndOfPacket[" + packetCounter + "]\n");
          }
          packetCounter++;
        }
      }
    }
 catch (    java.net.SocketTimeoutException noMoreDataException) {
      logger.error("Response already done!",noMoreDataException);
    }
catch (    EOFException eofException) {
      logger.error("received: \"" + retVal + "\"");
    }
catch (    IOException ioException) {
      logger.error("Cannot connect!",ioException);
    }
  }
 else {
    logger.debug("!!Not Connected to Receive ");
  }
  return retVal;
}
