{
  ZWaveNode node=this.getNode(nodeId);
  ZWaveSetCommands zwaveCommandClass=null;
  SerialMessage serialMessage=null;
  for (  CommandClass commandClass : new CommandClass[]{CommandClass.SWITCH_MULTILEVEL,CommandClass.SWITCH_BINARY,CommandClass.BASIC}) {
    zwaveCommandClass=(ZWaveSetCommands)node.resolveCommandClass(commandClass,endpoint);
    if (zwaveCommandClass != null)     break;
  }
  if (zwaveCommandClass == null) {
    logger.error("No Command Class found on node {}, instance/endpoint {} to request level.",nodeId,endpoint);
    return;
  }
  serialMessage=node.encapsulate(zwaveCommandClass.setValueMessage(value),(ZWaveCommandClass)zwaveCommandClass,endpoint);
  if (serialMessage != null)   this.sendData(serialMessage);
  if (((ZWaveCommandClass)zwaveCommandClass).getCommandClass() == CommandClass.SWITCH_MULTILEVEL && value == 255)   this.requestValue(nodeId,endpoint);
}
