{
  logger.debug("NODE {}: Update return routes",nodeId);
  ZWaveNode node=this.getNode(nodeId);
  if (node == null) {
    logger.error("NODE {}: Node not found!",nodeId);
    return;
  }
  if (node.isRouting() == false) {
    logger.debug("NODE {}: Node is not a routing node. No routes can be set.",nodeId);
    return;
  }
  ArrayList<Integer> routedNodes=new ArrayList<Integer>();
  ZWaveAssociationCommandClass associationCmdClass=(ZWaveAssociationCommandClass)node.getCommandClass(CommandClass.ASSOCIATION);
  int groups=associationCmdClass.getGroupCount();
  if (groups != 0) {
    for (int group=1; group <= groups; group++) {
      for (      Integer associationNodeId : associationCmdClass.getGroupMembers(group)) {
        routedNodes.add(associationNodeId);
      }
    }
  }
  ZWaveWakeUpCommandClass wakeupCmdClass=(ZWaveWakeUpCommandClass)node.getCommandClass(CommandClass.WAKE_UP);
  if (wakeupCmdClass != null) {
    Integer wakeupNodeId=wakeupCmdClass.getTargetNodeId();
    if (this.getNode(wakeupNodeId) != null) {
      routedNodes.add(wakeupNodeId);
    }
  }
  if (routedNodes.size() == 0) {
    logger.debug("NODE {}: No return routes required.",nodeId);
    return;
  }
  requestDeleteAllReturnRoutes(nodeId);
  requestAssignSucReturnRoute(nodeId);
  logger.debug("NODE {}: Adding {} return routes.",nodeId,routedNodes.size());
  for (  Integer destNodeId : routedNodes) {
    requestAssignReturnRoute(nodeId,destNodeId);
  }
}
