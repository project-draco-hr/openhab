{
  if (BindingType.brightness.equals(type) && command.equals(PercentType.ZERO)) {
    sendOff(bulb,bridgeId);
    return;
  }
  if (BindingType.brightness.equals(type) && command.equals(PercentType.HUNDRED)) {
    sendFull(bulb,bridgeId);
    return;
  }
  PercentType oldPercent=getCurrentState(bulb,bridgeId,type);
  if (oldPercent.equals(PercentType.ZERO))   sendOn(bulb,bridgeId);
  try {
    if (command.compareTo(oldPercent) > 0) {
      int repeatCount=(command.intValue() - oldPercent.intValue()) / 10;
      for (int i=0; i <= repeatCount; i++) {
        Thread.sleep(100);
        if (BindingType.brightness.equals(type)) {
          sendIncrease(bulb,bridgeId);
        }
 else         if (BindingType.colorTemperature.equals(type)) {
          sendWarmer(bulb,bridgeId);
        }
 else         if (BindingType.discoSpeed.equals(type)) {
          sendIncreaseSpeed(bulb,bridgeId);
        }
 else         if (BindingType.discoMode.equals(type)) {
          sendDiscoModeUp(bulb,bridgeId);
        }
      }
    }
 else     if (command.compareTo(oldPercent) < 0) {
      int repeatCount=(oldPercent.intValue() - command.intValue()) / 10;
      for (int i=0; i <= repeatCount; i++) {
        Thread.sleep(100);
        if (BindingType.brightness.equals(type)) {
          sendDecrease(bulb,bridgeId);
        }
 else         if (BindingType.colorTemperature.equals(type)) {
          sendCooler(bulb,bridgeId);
        }
 else         if (BindingType.discoSpeed.equals(type)) {
          sendDecreaseSpeed(bulb,bridgeId);
        }
 else         if (BindingType.discoMode.equals(type)) {
          sendDiscoModeDown(bulb,bridgeId);
        }
      }
    }
    setCurrentState(bulb,bridgeId,command,type);
  }
 catch (  InterruptedException e) {
    logger.debug("Sleeping thread has been interrupted.");
  }
}
