{
  PersistenceService service=services.get(serviceName);
  if (service instanceof QueryablePersistenceService) {
    QueryablePersistenceService qService=(QueryablePersistenceService)service;
    FilterCriteria filter=new FilterCriteria();
    filter.setItemName(item.getName());
    filter.setOrdering(Ordering.DESCENDING);
    filter.setPageSize(3);
    int startPage=0;
    filter.setPageNumber(startPage);
    Iterable<HistoricItem> items=qService.query(filter);
    while (items != null) {
      Iterator<HistoricItem> itemIterator=items.iterator();
      int itemCount=0;
      while (itemIterator.hasNext()) {
        HistoricItem historicItem=itemIterator.next();
        itemCount++;
        if (!historicItem.getState().equals(item.getState())) {
          return historicItem;
        }
      }
      if (itemCount == filter.getPageSize()) {
        filter.setPageNumber(++startPage);
        items=qService.query(filter);
      }
 else {
        items=null;
      }
    }
    return null;
  }
 else {
    logger.warn("There is no queryable persistence service registered with the name '{}'",serviceName);
    return null;
  }
}
