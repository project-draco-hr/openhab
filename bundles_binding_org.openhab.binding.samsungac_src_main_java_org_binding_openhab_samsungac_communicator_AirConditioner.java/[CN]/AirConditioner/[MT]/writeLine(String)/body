{
  logger.debug("Sending request:'" + line + "'");
  if (!isConnected()) {
    login();
  }
  BufferedWriter writer;
  try {
    writer=new BufferedWriter(new OutputStreamWriter(socket.getOutputStream()));
    writer.write(line);
    writer.newLine();
    writer.flush();
  }
 catch (  Exception e) {
    logger.info("Could not write line. Disconnecting..., exception was: " + e);
    disconnect();
    throw (e);
  }
}
