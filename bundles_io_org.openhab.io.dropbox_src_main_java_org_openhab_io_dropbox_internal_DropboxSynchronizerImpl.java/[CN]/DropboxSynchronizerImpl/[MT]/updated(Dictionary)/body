{
  if (config != null) {
    DropboxSynchronizerImpl.appKey=(String)config.get("appkey");
    DropboxSynchronizerImpl.appSecret=(String)config.get("appsecret");
    String contentDirString=(String)config.get("contentdir");
    if (StringUtils.isNotBlank(contentDirString)) {
      DropboxSynchronizerImpl.contentDir=contentDirString;
    }
    String refreshIntervalString=(String)config.get("refresh");
    if (StringUtils.isNotBlank(refreshIntervalString)) {
      DropboxSynchronizerImpl.refreshInterval=Long.parseLong(refreshIntervalString);
    }
    String syncModeString=(String)config.get("syncmode");
    if (StringUtils.isNotBlank(syncModeString)) {
      try {
        DropboxSynchronizerImpl.syncMode=DropboxSyncMode.valueOf(syncModeString.toUpperCase());
      }
 catch (      IllegalArgumentException iae) {
        throw new ConfigurationException("dropbox:syncmode","Unknown SyncMode '" + syncModeString + "'. Valid SyncModes are 'DROPBOX_TO_LOCAL', 'LOCAL_TO_DROPBOX' and 'BIDIRECTIONAL'.");
      }
    }
    String filterString=(String)config.get("filter");
    if (StringUtils.isNotBlank(filterString)) {
      String[] newFilterElements=filterString.split(",");
      filterElements.addAll(Arrays.asList(newFilterElements));
    }
    if (StringUtils.isBlank(DropboxSynchronizerImpl.appKey) || StringUtils.isBlank(DropboxSynchronizerImpl.appSecret)) {
      throw new ConfigurationException("dropbox:appkey","The parameters 'appkey' or 'appsecret' are missing! Please refer to your 'openhab.cfg'");
    }
    isProperlyConfigured=true;
    String activateString=(String)config.get("activate");
    if (StringUtils.isNotBlank(activateString)) {
      if (BooleanUtils.toBoolean(activateString)) {
        activate();
      }
 else {
        deactivate();
      }
    }
 else {
      activate();
    }
  }
}
