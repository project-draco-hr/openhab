{
  JobDataMap dataMap=context.getJobDetail().getJobDataMap();
  @SuppressWarnings("rawtypes") AbstractChannelEventSubscriberBinding.MuxChannel muxChannel=(AbstractChannelEventSubscriberBinding.MuxChannel)dataMap.get("MuxChannel");
  boolean jobDone=false;
  if (!muxChannel.isFaulty()) {
    try {
      if (!muxChannel.connectUntilFaulty()) {
        jobDone=true;
      }
    }
 catch (    IOException e2) {
      logger.error("An exception occured while connecting a channel: {}",e2.getMessage());
    }
    while (!jobDone) {
synchronized (muxChannel.readSelector) {
        try {
          muxChannel.readSelector.selectNow();
        }
 catch (        IOException e) {
        }
        Iterator<SelectionKey> it=muxChannel.readSelector.selectedKeys().iterator();
        while (it.hasNext()) {
          SelectionKey selKey=(SelectionKey)it.next();
          it.remove();
          if (selKey.isValid() && selKey.isReadable()) {
            ByteBuffer readBuffer=ByteBuffer.allocate(muxChannel.maxBufferSize);
            int numberBytesRead=0;
            try {
              numberBytesRead=muxChannel.read(readBuffer);
            }
 catch (            NotYetConnectedException e) {
              logger.warn("{} is apparently not yet connected",muxChannel);
            }
catch (            PortUnreachableException e) {
              logger.warn("An ICMP Port Unreachable message has been received on the connected channel {}",muxChannel);
              muxChannel.logFault();
              try {
                if (!muxChannel.isFaulty()) {
                  muxChannel.reconnect();
                }
 else {
                  jobDone=true;
                }
              }
 catch (              IOException e1) {
                logger.error("An exception occured while reconnecting a channel: {}",e1.getMessage());
              }
            }
catch (            IOException e) {
              logger.warn("{} has encountered an unknown IO Exception: {}",muxChannel,e.getMessage());
              muxChannel.logFault();
              try {
                if (!muxChannel.isFaulty()) {
                  muxChannel.reconnect();
                }
 else {
                  jobDone=true;
                }
              }
 catch (              IOException e1) {
                logger.error("An exception occured while reconnecting a channel: {}",e1.getMessage());
              }
            }
            if (numberBytesRead == -1) {
              if (!muxChannel.isConnected()) {
                try {
                  if (!muxChannel.isFaulty()) {
                    muxChannel.reconnect();
                  }
 else {
                    jobDone=true;
                  }
                }
 catch (                IOException e1) {
                  logger.error("An exception occured while reconnecting a channel: {}",e1.getMessage());
                }
              }
            }
 else {
              if (muxChannel.inBlockingWriteRead == true) {
                readBuffer.flip();
synchronized (muxChannel) {
                  muxChannel.blockingReadBuffer=readBuffer;
                  muxChannel.inBlockingWriteRead=false;
                }
              }
 else {
                readBuffer.flip();
                muxChannel.binding.parseChanneledBuffer(muxChannel,readBuffer);
              }
              jobDone=true;
            }
          }
        }
      }
    }
  }
}
