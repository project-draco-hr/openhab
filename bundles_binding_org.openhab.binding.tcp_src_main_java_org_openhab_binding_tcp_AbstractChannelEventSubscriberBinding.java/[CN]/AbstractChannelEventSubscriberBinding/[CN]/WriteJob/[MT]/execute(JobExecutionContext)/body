{
  JobDataMap dataMap=context.getJobDetail().getJobDataMap();
  @SuppressWarnings("rawtypes") AbstractChannelEventSubscriberBinding.MuxChannel muxChannel=(AbstractChannelEventSubscriberBinding.MuxChannel)dataMap.get("MuxChannel");
  ByteBuffer buffer=(ByteBuffer)dataMap.get("Buffer");
  boolean jobDone=false;
  try {
    if (!muxChannel.connectUntilFaulty()) {
      jobDone=true;
    }
  }
 catch (  IOException e2) {
    logger.error("An exception occured while connecting a channel: {}",e2.getMessage());
  }
  while (!jobDone) {
synchronized (muxChannel.writeSelector) {
      try {
        muxChannel.writeSelector.selectNow();
      }
 catch (      IOException e) {
      }
      Iterator<SelectionKey> it=muxChannel.writeSelector.selectedKeys().iterator();
      while (it.hasNext()) {
        SelectionKey selKey=(SelectionKey)it.next();
        it.remove();
        if (selKey.isValid() && selKey.isWritable()) {
          buffer.rewind();
          try {
            muxChannel.write(buffer);
          }
 catch (          NotYetConnectedException e) {
            logger.warn("{} is apparently not yet connected",muxChannel);
          }
catch (          IOException e) {
            logger.warn("{} has encountered an unknown IO Exception: {}",muxChannel,e.getMessage());
            muxChannel.logFault();
            try {
              if (!muxChannel.isFaulty()) {
                muxChannel.reconnect();
              }
            }
 catch (            IOException e1) {
              logger.error("An exception occured while connecting a channel: {}",e1.getMessage());
            }
          }
          jobDone=true;
        }
      }
    }
  }
}
