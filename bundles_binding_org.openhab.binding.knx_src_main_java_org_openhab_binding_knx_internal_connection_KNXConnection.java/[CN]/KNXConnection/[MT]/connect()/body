{
  boolean successRetVal=false;
  sShutdown=false;
  try {
    if (StringUtils.isNotBlank(sIp)) {
      sLink=connectByIp(sIpConnectionType,sLocalIp,sIp,sPort);
    }
 else     if (StringUtils.isNotBlank(sSerialPort)) {
      sLink=connectBySerial(sSerialPort);
    }
 else {
      sLogger.error("No IP address or serial port could be found in configuration!");
      return false;
    }
    NetworkLinkListener linkListener=new NetworkLinkListener(){
      public void linkClosed(      CloseEvent e){
        if (!(CloseEvent.USER_REQUEST == e.getInitiator()) && !sShutdown) {
          sLogger.warn("KNX link has been lost (reason: {} on object {}) - reconnecting...",e.getReason(),e.getSource().toString());
          connect();
        }
        if (!sLink.isOpen() && !sShutdown) {
          sLogger.error("KNX link has been lost!");
          if (sAutoReconnectPeriod > 0) {
            sLogger.info("KNX link will be retried in " + sAutoReconnectPeriod + " seconds");
            final Timer timer=new Timer();
            TimerTask timerTask=new TimerTask(){
              @Override public void run(){
                if (sShutdown) {
                  timer.cancel();
                }
 else {
                  sLogger.info("Trying to reconnect to KNX...");
                  connect();
                  if (sLink.isOpen()) {
                    timer.cancel();
                  }
                }
              }
            }
;
            timer.schedule(timerTask,sAutoReconnectPeriod * 1000,sAutoReconnectPeriod * 1000);
          }
        }
      }
      public void indication(      FrameEvent e){
      }
      public void confirmation(      FrameEvent e){
      }
    }
;
    sLink.addLinkListener(linkListener);
    if (sPC != null) {
      sPC.removeProcessListener(sProcessCommunicationListener);
      sPC.detach();
    }
    sPC=new ProcessCommunicatorImpl(sLink);
    sPC.setResponseTimeout((int)sResponseTimeout / 1000);
    if (sProcessCommunicationListener != null) {
      sPC.addProcessListener(sProcessCommunicationListener);
    }
    for (    KNXConnectionListener listener : KNXConnection.sConnectionListeners) {
      listener.connectionEstablished();
    }
    successRetVal=true;
    if (sLogger.isInfoEnabled()) {
      if (sLink instanceof KNXNetworkLinkIP) {
        String ipConnectionTypeString=KNXConnection.sIpConnectionType == KNXNetworkLinkIP.ROUTING ? "ROUTER" : "TUNNEL";
        sLogger.info("Established connection to KNX bus on {} in mode {}.",sIp + ":" + sPort,ipConnectionTypeString);
      }
 else {
        sLogger.info("Established connection to KNX bus through FT1.2 on serial port {}.",sSerialPort);
      }
    }
  }
 catch (  KNXException e) {
    sLogger.error("Error connecting to KNX bus: {}",e.getMessage());
  }
catch (  UnknownHostException e) {
    sLogger.error("Error connecting to KNX bus (unknown host): {}",e.getMessage());
  }
catch (  InterruptedException e) {
    sLogger.error("Error connecting to KNX bus (interrupted): {}",e.getMessage());
  }
  return successRetVal;
}
