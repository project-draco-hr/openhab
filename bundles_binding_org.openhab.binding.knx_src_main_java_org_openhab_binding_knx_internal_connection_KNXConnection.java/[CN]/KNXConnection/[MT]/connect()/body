{
  if ((ip != null && !ip.isEmpty()) || (port != null && !port.isEmpty())) {
    try {
      if (ip != null) {
        link=new KNXNetworkLinkIP(ip,new KNXMediumSettings(null){
          public short getMedium(){
            return KNXMediumSettings.MEDIUM_TP1;
          }
        }
);
      }
 else {
        link=new KNXNetworkLinkFT12(Integer.parseInt(port),new TPSettings(true));
      }
      link.addLinkListener(new NetworkLinkListener(){
        public void linkClosed(        CloseEvent e){
          if (!e.isUserRequest()) {
            logger.warn("KNX link has been lost (reason: {} on object {}) - reconnecting...",e.getReason(),e.getSource().toString());
            connect();
          }
          if (!link.isOpen()) {
            logger.error("KNX link has been lost!");
          }
        }
        public void indication(        FrameEvent e){
        }
        public void confirmation(        FrameEvent e){
        }
      }
);
      if (pc != null) {
        pc.removeProcessListener(listener);
        pc.detach();
      }
      pc=new ProcessCommunicatorImpl(link);
      pc.setResponseTimeout(10);
      if (listener != null) {
        pc.addProcessListener(listener);
      }
      logger.info("Established connection to KNX bus on IP {}.",ip);
    }
 catch (    KNXException e) {
      logger.error("Error connecting to KNX bus",e);
    }
  }
 else {
    logger.error("No IP address or serial port could be found in configuration!");
  }
}
