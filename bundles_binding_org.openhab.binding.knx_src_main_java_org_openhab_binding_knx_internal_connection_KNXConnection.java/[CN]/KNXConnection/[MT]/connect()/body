{
  if (ip != null && !ip.isEmpty()) {
    try {
      InetSocketAddress localEndPoint=null;
      if (localIp != null && !localIp.isEmpty()) {
        localEndPoint=new InetSocketAddress(localIp,0);
      }
 else {
        localEndPoint=new InetSocketAddress(InetAddress.getLocalHost(),0);
      }
      link=new KNXNetworkLinkIP(KNXNetworkLinkIP.TUNNEL,localEndPoint,new InetSocketAddress(ip,port),false,TPSettings.TP1);
      link.addLinkListener(new NetworkLinkListener(){
        public void linkClosed(        CloseEvent e){
          if (!e.isUserRequest()) {
            logger.warn("KNX link has been lost (reason: {} on object {}) - reconnecting...",e.getReason(),e.getSource().toString());
            connect();
          }
          if (!link.isOpen()) {
            logger.error("KNX link has been lost!");
          }
        }
        public void indication(        FrameEvent e){
        }
        public void confirmation(        FrameEvent e){
        }
      }
);
      if (pc != null) {
        pc.removeProcessListener(listener);
        pc.detach();
      }
      pc=new ProcessCommunicatorImpl(link);
      pc.setResponseTimeout(10);
      if (listener != null) {
        pc.addProcessListener(listener);
      }
      logger.info("Established connection to KNX bus on {}.",ip + ":" + port);
    }
 catch (    KNXException e) {
      logger.error("Error connecting to KNX bus",e);
    }
catch (    UnknownHostException e) {
      logger.error("Error connecting to KNX bus",e);
    }
  }
 else {
    logger.error("No IP address could be found in configuration!");
  }
}
