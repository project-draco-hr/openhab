{
  Switch s=(Switch)w;
  String snippetName=null;
  Item item;
  try {
    item=itemUIRegistry.getItem(w.getItem());
    if (s.getMappings().size() == 0) {
      if (item instanceof RollershutterItem) {
        snippetName="rollerblind";
      }
 else       if (item instanceof GroupItem && ((GroupItem)item).getBaseItem() instanceof RollershutterItem) {
        snippetName="rollerblind";
      }
 else {
        snippetName="switch";
      }
    }
 else {
      snippetName="buttons";
    }
  }
 catch (  ItemNotFoundException e) {
    logger.warn("Cannot determine item type of '{}'",w.getItem(),e);
    snippetName="switch";
  }
  String snippet=getSnippet(snippetName);
  snippet=snippet.replaceAll("%id%",itemUIRegistry.getWidgetId(w));
  snippet=snippet.replaceAll("%icon%",itemUIRegistry.getIcon(w));
  snippet=snippet.replaceAll("%item%",w.getItem());
  snippet=snippet.replaceAll("%label%",getLabel(w));
  snippet=snippet.replaceAll("%servletname%",WebAppServlet.SERVLET_NAME);
  State state=itemUIRegistry.getState(w);
  if (s.getMappings().size() == 0) {
    if (state instanceof PercentType) {
      state=((PercentType)state).intValue() > 0 ? OnOffType.ON : OnOffType.OFF;
    }
    if (state.equals(OnOffType.ON)) {
      snippet=snippet.replaceAll("%checked%","checked=true");
    }
 else {
      snippet=snippet.replaceAll("%checked%","");
    }
  }
 else {
    StringBuilder buttons=new StringBuilder();
    for (    Mapping mapping : s.getMappings()) {
      String button=getSnippet("button");
      button=button.replaceAll("%item%",w.getItem());
      button=button.replaceAll("%cmd%",mapping.getCmd());
      button=button.replaceAll("%label%",mapping.getLabel());
      if (s.getMappings().size() > 1 && state.toString().equals(mapping.getCmd())) {
        button=button.replaceAll("%type%","Warn");
      }
 else {
        button=button.replaceAll("%type%","Action");
      }
      buttons.insert(0,button);
    }
    snippet=snippet.replaceAll("%buttons%",buttons.toString());
  }
  sb.append(snippet);
  return null;
}
