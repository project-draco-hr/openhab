{
  String clientId=request.getHeader("X-Atmosphere-tracking-id");
  if (clientId == null || clientId.isEmpty()) {
    return false;
  }
  ObjectMapper mapper=new ObjectMapper();
  try {
    ConcurrentMap<String,Object> resources=ResourceStateChangeListener.getMap();
    for (    String uuid : resources.keySet()) {
      AtmosphereResource resource=AtmosphereResourceFactory.getDefault().find(uuid);
      if (resource == null) {
        logger.trace("removing {} from duplicate cache",uuid);
        resources.remove(uuid);
      }
    }
    String firedResponse=mapper.writeValueAsString(ResourceStateChangeListener.getMap().put(clientId,responseEntity));
    String responseValue=mapper.writeValueAsString(responseEntity);
    if (responseValue.equals(firedResponse)) {
      logger.trace("Duplicate message for uuid {}",clientId);
      return true;
    }
  }
 catch (  Exception e) {
    logger.error(e.getMessage());
  }
  return false;
}
