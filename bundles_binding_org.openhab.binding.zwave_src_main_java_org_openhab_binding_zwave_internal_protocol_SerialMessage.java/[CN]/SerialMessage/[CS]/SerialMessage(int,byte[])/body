{
  logger.debug("NODE {}: Creating new SerialMessage from buffer = {}",nodeId,SerialMessage.bb2hex(buffer));
  messageLength=buffer.length - 2;
  byte messageCheckSumm=calculateChecksum(buffer);
  byte messageCheckSummReceived=buffer[messageLength + 1];
  logger.trace(String.format("NODE %d: Message checksum calculated = 0x%02X, received = 0x%02X",nodeId,messageCheckSumm,messageCheckSummReceived));
  if (messageCheckSumm == messageCheckSummReceived) {
    logger.trace("NODE {}: Checksum matched",nodeId);
    isValid=true;
  }
 else {
    logger.trace("NODE {}: Checksum error",nodeId);
    isValid=false;
    return;
  }
  this.messageType=buffer[2] == 0x00 ? SerialMessageType.Request : SerialMessageType.Response;
  ;
  this.messageClass=SerialMessageClass.getMessageClass(buffer[3] & 0xFF);
  this.messagePayload=ArrayUtils.subarray(buffer,4,messageLength + 1);
  this.messageNode=nodeId;
  logger.debug("NODE {}: Message payload = {}",getMessageNode(),SerialMessage.bb2hex(messagePayload));
}
