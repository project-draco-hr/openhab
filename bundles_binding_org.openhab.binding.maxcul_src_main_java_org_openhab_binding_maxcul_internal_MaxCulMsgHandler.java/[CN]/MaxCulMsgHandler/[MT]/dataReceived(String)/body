{
  logger.debug("MaxCulSender Received " + data);
  if (data.startsWith("Z")) {
    if (listenMode) {
      listenModeHandler(data);
      return;
    }
    if (BaseMsg.isForUs(data,srcAddr)) {
      MaxCulMsgType msgType=BaseMsg.getMsgType(data);
      if (msgType == MaxCulMsgType.ACK) {
        AckMsg msg=new AckMsg(data);
        if (pendingAckQueue.containsKey(msg.msgCount) && msg.dstAddrStr.compareTo(srcAddr) == 0) {
          SenderQueueItem qi=pendingAckQueue.remove(msg.msgCount);
          if ((qi.msg.dstAddrStr.equalsIgnoreCase(msg.srcAddrStr)) && (qi.msg.srcAddrStr.equalsIgnoreCase(msg.dstAddrStr))) {
            if (msg.getIsNack()) {
              logger.error("Message was NAK'd, packet lost");
            }
 else             logger.debug("Message " + msg.msgCount + " ACK'd ok!");
          }
        }
 else         logger.info("Got ACK for message " + msg.msgCount + " but it wasn't in the queue");
        if (sequenceRegister.containsKey(new BaseMsg(data).msgCount)) {
          BaseMsg bMsg=new BaseMsg(data);
          logger.debug("Message " + bMsg.msgCount + " is part of sequence. Running next step in sequence.");
          sequenceRegister.get(bMsg.msgCount).runSequencer(bMsg);
        }
      }
 else       if (msgType == MaxCulMsgType.TIME_INFO) {
        TimeInfoMsg msg=new TimeInfoMsg(data);
        sendTimeInfoFast(msg.srcAddrStr,this.tzStr);
      }
 else       if (sequenceRegister.containsKey(new BaseMsg(data).msgCount)) {
        BaseMsg bMsg=new BaseMsg(data);
        logger.debug("Message " + bMsg.msgCount + " is part of sequence. Running next step in sequence.");
        sequenceRegister.get(bMsg.msgCount).runSequencer(bMsg);
      }
 else {
        this.mcbmp.MaxCulMsgReceived(data,false);
      }
    }
 else     if (BaseMsg.isForUs(data,"000000")) {
switch (BaseMsg.getMsgType(data)) {
case PAIR_PING:
case WALL_THERMOSTAT_CONTROL:
case THERMOSTAT_STATE:
case WALL_THERMOSTAT_STATE:
        this.mcbmp.MaxCulMsgReceived(data,true);
      break;
default :
    logger.debug("Unhandled broadcast message of type " + BaseMsg.getMsgType(data).toString());
  break;
}
}
}
}
