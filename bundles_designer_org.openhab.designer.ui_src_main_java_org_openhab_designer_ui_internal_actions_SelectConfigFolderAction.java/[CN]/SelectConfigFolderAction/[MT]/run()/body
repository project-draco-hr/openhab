{
  Shell shell=PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell();
  DirectoryDialog dialog=new DirectoryDialog(shell,SWT.OPEN);
  dialog.setMessage("Select the configuration folder of the openHAB runtime");
  String selection=dialog.open();
  if (selection != null) {
    try {
      File file=new File(selection);
      if (isValidConfigurationFolder(file)) {
        ConfigurationFolderProvider.saveFolderToPreferences(selection);
        ConfigurationFolderProvider.setRootConfigurationFolder(new File(selection));
        viewer.setInput(ConfigurationFolderProvider.getRootConfigurationFolder());
      }
 else {
        MessageDialog.openError(shell,"No valid configuration directory","The chosen directory is not a valid openHAB configuration" + " directory. Please choose a different one.");
      }
    }
 catch (    CoreException e) {
      IStatus status=new Status(IStatus.ERROR,UIActivator.PLUGIN_ID,"An error occurred while opening the configuration folder",e);
      ErrorDialog.openError(shell,"Cannot open configuration folder!",null,status);
    }
  }
}
