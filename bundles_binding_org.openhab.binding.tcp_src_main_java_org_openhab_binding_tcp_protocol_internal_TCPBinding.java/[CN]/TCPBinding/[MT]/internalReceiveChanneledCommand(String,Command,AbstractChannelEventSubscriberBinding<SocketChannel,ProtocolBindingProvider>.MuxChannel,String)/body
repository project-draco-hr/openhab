{
  ProtocolBindingProvider provider=findFirstMatchingBindingProvider(itemName);
  if (command != null) {
    String tcpCommandName=null;
    if (command instanceof DecimalType) {
      tcpCommandName=commandAsString;
    }
 else {
      tcpCommandName=provider.getProtocolCommand(itemName,command);
    }
    tcpCommandName=tcpCommandName + ((char)13) + ((char)10);
    Direction direction=provider.getDirection(itemName,command);
    if (direction.equals(Direction.OUT) | direction.equals(Direction.BIDIRECTIONAL)) {
      ByteBuffer outputBuffer=ByteBuffer.allocate(1024);
      try {
        outputBuffer.put(tcpCommandName.getBytes("ASCII"));
      }
 catch (      UnsupportedEncodingException e) {
        logger.warn("Exception while attempting an unsupported encoding scheme");
      }
      try {
        @SuppressWarnings("unused") ByteBuffer response=sChannel.writeBuffer(outputBuffer,false,3000);
      }
 catch (      Exception e) {
        logger.error("An exception occured while writing a buffer to a channel: {}",e.getMessage());
      }
      return true;
    }
 else {
      logger.error("TCPCommand has the wrong direction");
    }
  }
  return false;
}
