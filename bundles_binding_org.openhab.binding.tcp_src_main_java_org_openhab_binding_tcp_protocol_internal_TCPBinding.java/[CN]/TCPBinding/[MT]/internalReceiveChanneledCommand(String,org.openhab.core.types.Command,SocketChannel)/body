{
  ProtocolBindingProvider provider=findFirstMatchingBindingProvider(itemName);
  Item theItem=getItemFromItemName(itemName);
  String tcpCommandName=null;
  Command finalCommand=null;
  if (command instanceof StringType && theItem != null) {
    try {
      finalCommand=createCommandFromString(theItem,"*");
    }
 catch (    Exception e) {
      logger.warn("Exception occured whilst creating a Command for item {}",theItem);
    }
    tcpCommandName=command.toString();
  }
 else {
    finalCommand=command;
    tcpCommandName=provider.getProtocolCommand(itemName,finalCommand);
  }
  tcpCommandName=tcpCommandName + ((char)13) + ((char)10);
  if (finalCommand != null) {
    Direction direction=provider.getDirection(itemName,finalCommand);
    if (direction.equals(Direction.OUT) | direction.equals(Direction.BIDIRECTIONAL)) {
      ByteBuffer outputBuffer=ByteBuffer.allocate(1024);
      try {
        outputBuffer.put(tcpCommandName.getBytes("ASCII"));
      }
 catch (      UnsupportedEncodingException e) {
        logger.warn("Exception while attempting an unsupported encoding scheme");
      }
      @SuppressWarnings("unused") ByteBuffer response=writeBuffer(sChannel,outputBuffer,false,3000);
      return true;
    }
 else {
      logger.error("TCPCommand has the wrong direction");
    }
  }
  return false;
}
