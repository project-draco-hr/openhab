{
  for (  HttpBindingProvider provider : providers) {
    for (    String itemName : provider.getInBindingItemNames()) {
      String url=provider.getUrl(itemName);
      int refreshInterval=provider.getRefreshInterval(itemName);
      String transformation=provider.getTransformation(itemName);
      Long lastUpdateTimeStamp=lastUpdateMap.get(itemName);
      if (lastUpdateTimeStamp == null) {
        lastUpdateTimeStamp=0L;
      }
      long age=System.currentTimeMillis() - lastUpdateTimeStamp;
      boolean needsUpdate=age >= refreshInterval;
      if (needsUpdate) {
        logger.debug("item '{}' is about to be refreshed now",itemName);
        String response=HttpUtil.executeUrl("GET",url,timeout);
        String transformedResponse;
        try {
          if (tsAggregator != null) {
            transformedResponse=tsAggregator.transform(transformation,response);
          }
 else {
            transformedResponse=response;
            logger.warn("couldn't transform response because transformationService is unavailable");
          }
        }
 catch (        TransformationException te) {
          logger.error("transformation throws exception [transformation=" + transformation + ", response="+ response+ "]",te);
          transformedResponse=response;
        }
        String abbreviatedResponse=StringUtils.abbreviate(transformedResponse,256).trim();
        logger.debug("transformed response is '{}'",transformedResponse);
        Item item=getItemFromItemName(itemName);
        State state=createState(item,abbreviatedResponse);
        if (state != null) {
          eventPublisher.postUpdate(itemName,state);
        }
        lastUpdateMap.put(itemName,System.currentTimeMillis());
      }
    }
  }
}
