{
  logger.debug("Received HTTP GET request at '{}' for media type '{}'.",new String[]{uriInfo.getPath(),type});
  if (atmosphereTransport == null || atmosphereTransport.isEmpty()) {
    String responseType=MediaTypeHelper.getResponseMediaType(headers.getAcceptableMediaTypes(),type);
    if (responseType != null) {
      Object responseObject=responseType.equals(MediaTypeHelper.APPLICATION_X_JAVASCRIPT) ? new JSONWithPadding(getPageBean(sitemapname,pageId,uriInfo.getBaseUriBuilder().build()),callback) : getPageBean(sitemapname,pageId,uriInfo.getBaseUriBuilder().build());
      throw new WebApplicationException(Response.ok(responseObject,responseType).build());
    }
 else {
      throw new WebApplicationException(Response.notAcceptable(null).build());
    }
  }
  GeneralBroadcaster sitemapBroadcaster=(GeneralBroadcaster)BroadcasterFactory.getDefault().lookup(GeneralBroadcaster.class,resource.getRequest().getPathInfo(),true);
  sitemapBroadcaster.addStateChangeListener(new SitemapStateChangeListener());
  return new SuspendResponse.SuspendResponseBuilder<Response>().scope(SCOPE.REQUEST).resumeOnBroadcast(!ResponseTypeHelper.isStreamingTransport(resource.getRequest())).broadcaster(sitemapBroadcaster).outputComments(true).build();
}
