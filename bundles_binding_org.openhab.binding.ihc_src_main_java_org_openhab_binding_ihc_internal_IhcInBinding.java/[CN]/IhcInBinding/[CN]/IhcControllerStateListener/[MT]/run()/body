{
  logger.debug("IHC Listener started");
  WSControllerState oldState=null;
  while (!interrupted) {
    IhcClient ihc=IhcConnection.getCommunicator();
    if (ihc != null) {
      try {
        if (oldState == null) {
          oldState=ihc.queryControllerState();
          logger.debug("Controller initial state {}",oldState.getState());
        }
        logger.debug("Wait new state change notification from controller");
        WSControllerState currentState=ihc.waitStateChangeNotifications(oldState,10);
        logger.debug("Controller state {}",currentState.getState());
        if (oldState.getState().equals(currentState.getState()) == false) {
          logger.info("Controller state change detected ({} -> {})",oldState.getState(),currentState.getState());
          if (oldState.getState().equals(IhcClient.CONTROLLER_STATE_INITIALIZE) || currentState.getState().equals(IhcClient.CONTROLLER_STATE_READY)) {
            logger.debug("Reopen connection...");
            IhcConnection.connect();
          }
          oldState.setState(currentState.getState());
        }
      }
 catch (      IOException e) {
        logger.error("New controller state change notification wait failed...reinitialize connection",e);
        try {
          IhcConnection.reconnect();
        }
 catch (        Exception e2) {
          logger.error("Communication error",e2);
          mysleep(1000L);
        }
      }
catch (      Exception e) {
        logger.error("Exception",e);
        mysleep(5000L);
      }
    }
 else {
      logger.warn("Controller is null => resource value notfications waiting aborted!");
      mysleep(5000L);
    }
  }
}
