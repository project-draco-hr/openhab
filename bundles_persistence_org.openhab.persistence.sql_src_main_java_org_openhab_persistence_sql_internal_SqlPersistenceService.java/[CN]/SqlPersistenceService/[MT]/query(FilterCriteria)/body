{
  if (initialized) {
    if (!isConnected()) {
      connectToDatabase();
    }
    if (isConnected()) {
      String itemName=filter.getItemName();
      String table=getTable(itemName);
      if (table == null) {
        logger.error("Unable to find table for query '" + itemName + "'.");
        return Collections.emptyList();
      }
      long start=filter.getBeginDate() == null ? 0L : filter.getBeginDate().getTime();
      long end=filter.getEndDate() == null ? System.currentTimeMillis() : filter.getEndDate().getTime();
      try {
        Statement st=connection.createStatement();
        st.setFetchSize(50);
        String query=new String("SELECT Time, Value FROM " + table + " WHERE TIME>"+ start+ " AND TIME<"+ end+ " LIMIT "+ filter.getPageSize());
        logger.debug("SQL query: " + query);
        ResultSet rs=st.executeQuery(query);
        double value;
        List<HistoricItem> items=new ArrayList<HistoricItem>();
        while (rs.next()) {
          value=rs.getDouble(2);
          State v=new DecimalType(value);
          SqlItem sqlItem=new SqlItem(itemName,v,new Date(rs.getLong(1)));
          items.add(sqlItem);
        }
        rs.close();
        st.close();
        return items;
      }
 catch (      SQLException e) {
        logger.error("Error running SQL querying : " + e.getMessage());
      }
    }
  }
  return Collections.emptyList();
}
