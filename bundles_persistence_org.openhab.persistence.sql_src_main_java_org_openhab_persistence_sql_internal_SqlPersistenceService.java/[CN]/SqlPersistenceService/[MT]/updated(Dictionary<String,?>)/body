{
  if (config != null) {
    Enumeration<String> keys=config.keys();
    while (keys.hasMoreElements()) {
      String key=(String)keys.nextElement();
      Matcher matcher=EXTRACT_CONFIG_PATTERN.matcher(key);
      if (!matcher.matches()) {
        continue;
      }
      matcher.reset();
      matcher.find();
      if (!matcher.group(1).equals("sqltype"))       continue;
      String itemType=matcher.group(2).toUpperCase() + "ITEM";
      String value=(String)config.get(key);
      sqlTypes.put(itemType,value);
    }
    driverClass=(String)config.get("driverClass");
    if (StringUtils.isBlank(driverClass)) {
      throw new ConfigurationException("sql:driverClass","The SQL driver class is missing - please configure the sql:driverClass parameter in openhab.cfg");
    }
    url=(String)config.get("url");
    if (StringUtils.isBlank(url)) {
      throw new ConfigurationException("sql:url","The SQL database URL is missing - please configure the sql:url parameter in openhab.cfg");
    }
    user=(String)config.get("user");
    if (StringUtils.isBlank(user)) {
      throw new ConfigurationException("sql:user","The SQL user is missing - please configure the sql:user parameter in openhab.cfg");
    }
    password=(String)config.get("password");
    if (StringUtils.isBlank(password)) {
      throw new ConfigurationException("sql:password","The SQL password is missing. Attempting to connect without password. To specify a password configure the sql:password parameter in openhab.cfg.");
    }
    String errorThresholdString=(String)config.get("reconnectCnt");
    if (StringUtils.isNotBlank(errorThresholdString)) {
      errReconnectThreshold=Integer.parseInt(errorThresholdString);
    }
    disconnectFromDatabase();
    connectToDatabase();
    initialized=true;
  }
}
