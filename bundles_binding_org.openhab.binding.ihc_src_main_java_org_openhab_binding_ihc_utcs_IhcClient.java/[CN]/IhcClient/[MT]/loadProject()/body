{
  Document doc=null;
  if (projectFile != null && projectFile != "") {
    logger.debug("Loading IHC /ELKO LS project file from path {}...",projectFile);
    try {
      DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
      DocumentBuilder db=dbf.newDocumentBuilder();
      doc=db.parse(new File(projectFile));
    }
 catch (    Exception e) {
      logger.error("Project file loading error",e);
    }
  }
 else {
    logger.debug("Loading IHC /ELKO LS project file from controller...");
    try {
      WSProjectInfo projectInfo=queryProjectInfo();
      int numberOfSegments=queryProjectNumberOfSegments();
      int segmentationSize=queryProjectSegmentationSize();
      logger.debug("Number of segments: {}",numberOfSegments);
      logger.debug("Segmentation size: {}",segmentationSize);
      ByteArrayOutputStream byteStream=new ByteArrayOutputStream();
      for (int i=0; i < numberOfSegments; i++) {
        logger.debug("Downloading segment {}",i);
        WSFile data=queryProjectSegment(i,projectInfo.getProjectMajorRevision(),projectInfo.getProjectMinorRevision());
        byteStream.write(data.getData());
      }
      logger.debug("File size before base64 encoding: {} bytes",byteStream.size());
      byte[] decodedBytes=javax.xml.bind.DatatypeConverter.parseBase64Binary(byteStream.toString());
      logger.debug("File size after base64 encoding: {} bytes",decodedBytes.length);
      GZIPInputStream gzis=new GZIPInputStream(new ByteArrayInputStream(decodedBytes));
      InputStreamReader in=new InputStreamReader(gzis,"ISO-8859-1");
      InputSource reader=new InputSource(in);
      DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
      DocumentBuilder db=dbf.newDocumentBuilder();
      doc=db.parse(reader);
    }
 catch (    Exception e) {
      logger.error("Project file loading error",e);
    }
  }
  parseProject(doc);
}
