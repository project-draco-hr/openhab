{
  if (getToken() != null) {
    Map<String,BindingConfig> clonedConfigMap=getConfigMap();
    Map<String,Item> clonedItemMap=getNameToItemMap();
    Map<String,Device> clonedCachedDeviceMap=getAllDigitalSTROMDevicesMap();
    List<String> meterList=digitalSTROM.getMeterList(getToken());
    Map<String,Device> clonedDsidToDeviceMap=getDsidToDeviceMap();
    for (    BindingConfig conf : clonedConfigMap.values()) {
      DigitalSTROMBindingConfigItem configItem=(DigitalSTROMBindingConfigItem)conf;
      if (configItem.dsid != null) {
        Device device=null;
        if (clonedDsidToDeviceMap.containsKey(configItem.dsid.getValue())) {
          device=clonedDsidToDeviceMap.get(configItem.dsid.getValue());
        }
 else {
          device=clonedCachedDeviceMap.get(configItem.dsid.getValue());
        }
        if (device != null) {
          addDevice(configItem.itemName,device);
          if (configItem.timeinterval > 0) {
            if (configItem.consumption == null) {
              configItem.consumption=ConsumptionConfig.ACTIVE_POWER;
            }
            addDeviceConsumptionThread(device,configItem.consumption,configItem.timeinterval);
          }
        }
      }
 else       if (configItem.dsmid != null) {
        Item item=clonedItemMap.get(configItem.itemName);
        if (item != null) {
          if (configItem.dsmid.getValue().equals("ALL")) {
            if (apartmentConsumptionThread != null) {
              apartmentConsumptionThread.setShutdown(true);
            }
            apartmentConsumptionThread=new ApartmentConsumptionThread(item,configItem.timeinterval);
          }
 else {
            if (meterList.contains(configItem.dsmid.getValue())) {
              if (configItem.timeinterval > 0) {
                if (configItem.consumption == null) {
                  configItem.consumption=ConsumptionConfig.ACTIVE_POWER;
                }
 else                 if (configItem.consumption.equals(ConsumptionConfig.OUTPUT_CURRENT)) {
                  configItem.consumption=ConsumptionConfig.ACTIVE_POWER;
                  logger.warn(ConsumptionConfig.OUTPUT_CURRENT.name() + " is not supportet by meters, by default setting ACTIVE_POWER");
                }
                addMeterConsumptionThread(item,configItem.dsmid.getValue(),configItem.timeinterval);
              }
            }
          }
        }
      }
    }
  }
}
