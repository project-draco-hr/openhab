{
  MochadX10BindingConfig deviceConfig=getConfigForItemName(itemName);
  if (deviceConfig == null) {
    return;
  }
  String address=deviceConfig.getAddress();
  String tm=deviceConfig.getTransmitMethod();
  String commandStr="none";
  Command previousCommand=lastIssuedCommand.get(address);
  if (command instanceof OnOffType) {
    commandStr=OnOffType.ON.equals(command) ? "on" : "off";
  }
 else   if (command instanceof UpDownType) {
    commandStr=UpDownType.UP.equals(command) ? "bright" : "dim";
  }
 else   if (command instanceof StopMoveType) {
    if (StopMoveType.STOP.equals(command)) {
      commandStr=UpDownType.UP.equals(previousCommand) ? "dim" : "bright";
    }
 else {
      commandStr="none";
    }
  }
 else   if (command instanceof PercentType) {
    if (deviceConfig.getItem() instanceof DimmerItem) {
      if (((PercentType)command).intValue() == 0) {
        commandStr="off";
      }
 else {
        long dim_value=Math.round(((PercentType)command).doubleValue() * 63.0 / 100);
        commandStr="xdim " + dim_value;
      }
    }
 else     if (deviceConfig.getItem() instanceof RollershutterItem) {
      Double invert_level=100 - ((PercentType)command).doubleValue();
      long level=Math.round(invert_level * 25.0 / 100);
      commandStr="extended_code_1 0 1 " + level;
    }
  }
 else   if (command instanceof IncreaseDecreaseType) {
    commandStr="none";
  }
  try {
    if (!commandStr.equals("none")) {
      Socket client=new Socket(hostIp,hostPort);
      client.setSoTimeout(3000);
      BufferedReader br=new BufferedReader(new InputStreamReader(client.getInputStream()));
      DataOutputStream out=new DataOutputStream(client.getOutputStream());
      out.writeBytes(tm + " " + address+ " "+ commandStr+ "\n");
      logger.debug(tm + " " + address+ " "+ commandStr);
      out.flush();
      logger.debug(br.readLine());
      logger.debug(br.readLine());
      out.close();
      client.close();
    }
  }
 catch (  IOException e) {
    logger.error(e.getMessage());
  }
  lastIssuedCommand.put(address,command);
}
