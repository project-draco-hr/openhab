{
  if (StringUtils.isEmpty(playerId))   throw new NullArgumentException("playerId");
  if (StringUtils.isEmpty(message))   throw new NullArgumentException("message");
  if (squeezeServer == null) {
    logger.warn("Squeeze Server yet to be initialised. Ignoring action.");
    return false;
  }
  if (!squeezeServer.isConnected()) {
    logger.warn("Not connected to the Squeeze Server. Please check your config and consult the openHAB WIKI for instructions on how to configure. Ignoring action.");
    return false;
  }
  SqueezePlayer player=squeezeServer.getPlayer(playerId);
  if (player == null) {
    logger.warn("No Squeezebox player exists with name '{}'. Ignoring action.",playerId);
    return false;
  }
  int playerVolume=player.getUnmuteVolume();
  boolean playerPowered=player.isPowered();
  boolean playerMuted=player.isMuted();
  if (playerMuted) {
    logger.trace("Setting player state: unmuted");
    squeezeServer.unMute(playerId);
  }
  if (volume != -1) {
    logger.trace("Setting player state: volume {}",volume);
    squeezeServer.setVolume(playerId,volume);
  }
  if (!StringUtils.isEmpty(display)) {
    logger.trace("Showing display string '{}' on device",display);
    squeezeServer.showString(playerId,display,5);
  }
  List<String> sentences=getSentences(message,MAX_SENTENCE_LENGTH);
  for (  String sentence : sentences) {
    logger.debug("Sending sentence to " + playerId + " ("+ sentence+ ")");
    String encodedSentence;
    try {
      encodedSentence=URLEncoder.encode(sentence,"UTF-8");
    }
 catch (    UnsupportedEncodingException e) {
      logger.warn("Failed to encode sentence '" + sentence + "'. Skipping sentence.",e);
      continue;
    }
    encodedSentence=encodedSentence.replace("+","%20");
    logger.trace("Encoded sentence " + encodedSentence);
    String url=GOOGLE_TRANSLATE_URL + encodedSentence;
    SqueezeboxListener listener=new SqueezeboxListener(playerId,url);
    player.addPlayerEventListener(listener);
    squeezeServer.playUrl(playerId,url);
    int timeoutCount=0;
    while (!listener.isFinished() && timeoutCount < 100) {
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
        break;
      }
      timeoutCount++;
    }
    player.removePlayerEventListener(listener);
    listener=null;
  }
  squeezeServer.clearPlaylist(playerId);
  if (volume != -1) {
    logger.trace("Restoring player to previous state: volume {}",playerVolume);
    squeezeServer.setVolume(playerId,playerVolume);
  }
  if (playerMuted) {
    logger.trace("Restoring player to previous state: muted");
    squeezeServer.mute(playerId);
  }
  if (!playerPowered) {
    logger.trace("Restoring player to previous state: off");
    squeezeServer.powerOff(playerId);
  }
  return true;
}
