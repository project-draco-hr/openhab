{
  logger.debug("received authentication request '{}'",authHeader);
  String[] authHeaders=authHeader.trim().split(" ");
  if (authHeaders.length == 2) {
    String authType=StringUtils.trim(authHeaders[0]);
    String authInfo=StringUtils.trim(authHeaders[1]);
    if (HttpServletRequest.BASIC_AUTH.equalsIgnoreCase(authType)) {
      try {
        String authInfoString=new String(Base64.decodeBase64(authInfo));
        String[] authInfos=authInfoString.split(":");
        if (authInfos.length < 2) {
          logger.debug("authInfos '{}' must contain two elements separated by a colon",authInfoString);
          return false;
        }
        String username=authInfos[0];
        String password=authInfos[1];
        logger.debug("extraced user '{}' -> going to authenticate!",username);
        Subject subject=authenticate(realm,username,password);
        if (subject != null) {
          request.setAttribute(HttpContext.AUTHENTICATION_TYPE,HttpServletRequest.BASIC_AUTH);
          request.setAttribute(HttpContext.REMOTE_USER,username);
          request.setAttribute("openHAB subject",subject);
          logger.info("login of user '{}' succeeded!",username);
          return true;
        }
      }
 catch (      Exception e) {
        logger.error("authentication request '" + authInfo + "' went wrong",e);
      }
    }
 else {
      logger.warn("we don't support '{}' authentication -> processing aborted",authType);
    }
  }
 else {
    logger.warn("authentication header '{}' must contain of two parts separated by a blank",authHeader);
  }
  return false;
}
