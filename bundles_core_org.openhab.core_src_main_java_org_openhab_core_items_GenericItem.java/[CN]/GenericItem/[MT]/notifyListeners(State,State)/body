{
  Set<StateChangeListener> clonedListeners=null;
  clonedListeners=new CopyOnWriteArraySet<StateChangeListener>(listeners);
  for (  StateChangeListener listener : clonedListeners) {
    listener.stateUpdated(this,newState);
  }
  if (!oldState.equals(newState)) {
    for (    StateChangeListener listener : clonedListeners) {
      listener.stateChanged(this,oldState,newState);
    }
  }
}
