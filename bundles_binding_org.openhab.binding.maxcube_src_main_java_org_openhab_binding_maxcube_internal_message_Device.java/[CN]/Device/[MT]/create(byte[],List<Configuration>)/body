{
  if (raw.length == 0) {
    return null;
  }
  String rfAddress=Utils.toHex(raw[0] & 0xFF,raw[1] & 0xFF,raw[2] & 0xFF);
  Device device=Device.create(rfAddress,configurations);
  if (device == null) {
    logger.warn("Can't create device from received message, returning NULL.");
  }
  boolean[] bits1=Utils.getBits(Utils.fromByte(raw[4]));
  boolean[] bits2=Utils.getBits(Utils.fromByte(raw[5]));
  device.setInitialized(bits1[1]);
  device.setAnswer(bits1[2]);
  device.setError(bits1[3]);
  device.setValid(bits1[4]);
  device.setDstSettingActive(bits2[3]);
  device.setGatewayKnown(bits2[4]);
  device.setPanelLocked(bits2[5]);
  device.setLinkStatusError(bits2[6]);
  device.setBatteryLow(bits2[7]);
switch (device.getType()) {
case WallMountedThermostat:
case HeatingThermostat:
case HeatingThermostatPlus:
    HeatingThermostat heatingThermostat=(HeatingThermostat)device;
  if (bits2[1] == false && bits2[0] == false) {
    heatingThermostat.setMode(ThermostatModeType.AUTOMATIC);
  }
 else   if (bits2[1] == false && bits2[0] == true) {
    heatingThermostat.setMode(ThermostatModeType.MANUAL);
  }
 else   if (bits2[1] == true && bits2[0] == false) {
    heatingThermostat.setMode(ThermostatModeType.VACATION);
  }
 else   if (bits2[1] == true && bits2[0] == true) {
    heatingThermostat.setMode(ThermostatModeType.BOOST);
  }
 else {
  }
heatingThermostat.setValvePosition(raw[6] & 0xFF);
heatingThermostat.setTemperatureSetpoint(raw[7] & 0xFF);
String hexDate=Utils.toHex(raw[8] & 0xFF,raw[9] & 0xFF);
int dateValue=Utils.fromHex(hexDate);
int timeValue=raw[10] & 0xFF;
Date date=Utils.resolveDateTime(dateValue,timeValue);
heatingThermostat.setDateSetpoint(date);
break;
case EcoSwitch:
String eCoSwitch=Utils.toHex(raw[3] & 0xFF,raw[4] & 0xFF,raw[5] & 0xFF);
logger.debug("EcoSwitch Device {} status bytes : {}",rfAddress,eCoSwitch);
break;
case ShutterContact:
ShutterContact shutterContact=(ShutterContact)device;
if (bits2[1] == true && bits2[0] == false) {
shutterContact.setShutterState(OpenClosedType.OPEN);
logger.trace("Device {} status: Open",rfAddress);
}
 else if (bits2[1] == false && bits2[0] == false) {
shutterContact.setShutterState(OpenClosedType.CLOSED);
logger.trace("Device {} status: Closed",rfAddress);
}
 else {
logger.trace("Device {} status switch status Unknown (true-true)",rfAddress);
}
break;
default :
break;
}
return device;
}
