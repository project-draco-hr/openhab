{
  logger.debug("Configuration updated, config {}",config != null ? true : false);
  if (config != null) {
    String granularityString=(String)config.get("granularity");
    if (StringUtils.isNotBlank(granularityString)) {
      granularity=Integer.parseInt(granularityString);
    }
    logger.debug("Granularity: {} ms",granularity);
    String tmp=(String)config.get("units");
    if (StringUtils.isNotBlank(tmp)) {
      if (tmp.length() != 1) {
        throw new ConfigurationException("units","Illegal units length");
      }
      if (!tmp.matches("[BKMGT]")) {
        throw new ConfigurationException("units","Illegal units");
      }
      units=tmp.charAt(0);
    }
    logger.debug("Using units: {}",units);
    initializeSystemMonitor();
    setProperlyConfigured(true);
  }
}
