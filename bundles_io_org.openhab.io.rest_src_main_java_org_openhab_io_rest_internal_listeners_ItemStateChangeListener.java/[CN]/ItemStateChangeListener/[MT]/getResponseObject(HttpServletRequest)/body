{
  String pathInfo=request.getPathInfo();
  if (pathInfo.endsWith("/state")) {
    if (pathInfo.startsWith("/" + ItemResource.PATH_ITEMS)) {
      String[] pathSegments=pathInfo.substring(1).split("/");
      if (pathSegments.length >= 2) {
        String itemName=pathSegments[1];
        Item item=ItemResource.getItem(itemName);
        if (item != null) {
          return item.getState().toString();
        }
      }
    }
  }
 else {
    String responseType=(new ResponseTypeHelper()).getResponseType(request);
    if (responseType != null) {
      String basePath=request.getScheme() + "://" + request.getServerName()+ ":"+ request.getServerPort()+ (request.getContextPath().equals("null") ? "" : request.getContextPath())+ RESTApplication.REST_SERVLET_ALIAS+ "/";
      if (pathInfo.startsWith("/" + ItemResource.PATH_ITEMS)) {
        String[] pathSegments=pathInfo.substring(1).split("/");
        if (pathSegments.length >= 2) {
          String itemName=pathSegments[1];
          Item item=ItemResource.getItem(itemName);
          if (item != null) {
            Object itemBean=ItemResource.createItemBean(item,true,basePath);
            return itemBean;
          }
        }
      }
    }
  }
  return null;
}
