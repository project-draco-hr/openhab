{
  try {
    SystemConfiguration sc=fbClient.getSystemManager().getConfiguration();
    ConnectionStatus cs=fbClient.getConnectionManager().getStatus();
    WifiGlobalConfig wc=fbClient.getWifiManager().getGlobalConfig();
    LCDConfig lcd=fbClient.getLCDManager().getLCDConfig();
    xDslStatus xdsl=fbClient.getConnectionManager().getxDslStatus();
    FtpConfig fc=fbClient.getFtpManager().getConfig();
    AirMediaConfig ac=fbClient.getAirMediaManager().getConfig();
    UPnPAVConfig uc=fbClient.getUPnPAVManager().getConfig();
    SambaConfig sac=fbClient.getNetShareManager().getSambaConfig();
    LanHostsConfig hc=fbClient.getLanManager().getAllLanHostsConfig();
    List<CallEntry> appels=fbClient.getCallManager().getCallEntries();
    PhoneCallComparator comparator=new PhoneCallComparator();
    Collections.sort(appels,comparator);
    for (    FreeboxBindingProvider provider : providers) {
      Collection<String> items=provider.getItemNames();
      for (      CallEntry call : appels) {
        if (call.getTimeStamp().after(lastPhoneCheck)) {
          for (          String itemName : items) {
            FreeboxBindingConfig bindingConfig=provider.getConfig(itemName);
            if (bindingConfig.commandParam == null || bindingConfig.commandParam.equalsIgnoreCase(call.getType())) {
switch (bindingConfig.commandType) {
case CALLSTATUS:
                setItemValue(bindingConfig.item,call.getType());
              break;
case CALLDURATION:
            setItemValue(bindingConfig.item,(long)call.getDuration());
          break;
case CALLNUMBER:
        setItemValue(bindingConfig.item,call.getNumber());
      break;
case CALLTIMESTAMP:
    setDateTimeValue(bindingConfig.item,call.getDateTime());
  break;
case CALLNAME:
setItemValue(bindingConfig.item,call.getName());
break;
}
}
}
}
}
lastPhoneCheck.setTimeInMillis(System.currentTimeMillis());
for (String itemName : items) {
FreeboxBindingConfig bindingConfig=provider.getConfig(itemName);
switch (bindingConfig.commandType) {
case REBOOT:
setItemValue(bindingConfig.item,false);
break;
case BYTESDOWN:
setItemValue(bindingConfig.item,cs.getBytes_down());
break;
case BYTESUP:
setItemValue(bindingConfig.item,cs.getBytes_up());
break;
case CPUB:
setItemValue(bindingConfig.item,(long)sc.getTemp_cpub());
break;
case CPUM:
setItemValue(bindingConfig.item,(long)sc.getTemp_cpum());
break;
case FAN:
setItemValue(bindingConfig.item,(long)sc.getFan_rpm());
break;
case FWVERSION:
setItemValue(bindingConfig.item,sc.getFirmware_version());
break;
case IPV4:
setItemValue(bindingConfig.item,cs.getIpv4());
break;
case LINESTATUS:
setItemValue(bindingConfig.item,cs.getState());
break;
case RATEDOWN:
setItemValue(bindingConfig.item,cs.getRate_down());
break;
case RATEUP:
setItemValue(bindingConfig.item,cs.getRate_up());
break;
case SW:
setItemValue(bindingConfig.item,(long)sc.getTemp_sw());
break;
case UPTIME:
setItemValue(bindingConfig.item,sc.getUptimeVal());
break;
case WIFISTATUS:
setItemValue(bindingConfig.item,wc.getEnabled());
break;
case LCDBRIGHTNESS:
setItemValue(bindingConfig.item,(long)lcd.getBrightness());
break;
case LCDORIENTATION:
setItemValue(bindingConfig.item,(long)lcd.getOrientation());
break;
case LCDFORCED:
setItemValue(bindingConfig.item,lcd.getOrientationForced());
break;
case XDSLSTATUS:
setItemValue(bindingConfig.item,xdsl.getStatus());
break;
case FTPSTATUS:
setItemValue(bindingConfig.item,fc.getEnabled());
break;
case AIRMEDIASTATUS:
setItemValue(bindingConfig.item,ac.getEnabled());
break;
case UPNPAVSTATUS:
setItemValue(bindingConfig.item,uc.getEnabled());
break;
case SAMBAFILESTATUS:
setItemValue(bindingConfig.item,sac.getFileShareEnabled());
break;
case SAMBAPRINTERSTATUS:
setItemValue(bindingConfig.item,sac.getPrintShareEnabled());
break;
case REACHABLEMAC:
setItemValue(bindingConfig.item,hc.isMacReachable(bindingConfig.commandParam));
break;
case REACHABLEIP:
setItemValue(bindingConfig.item,hc.isIpReachable(bindingConfig.commandParam));
break;
case REACHABLENAME:
setItemValue(bindingConfig.item,hc.isHostNameReachable(bindingConfig.commandParam));
break;
default :
break;
}
}
}
}
 catch (FreeboxException e) {
logger.info(e.getMessage());
}
}
