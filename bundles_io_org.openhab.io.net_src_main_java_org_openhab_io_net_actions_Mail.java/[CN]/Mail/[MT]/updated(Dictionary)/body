{
  if (config != null) {
    Mail.hostname=(String)config.get("hostname");
    String portString=(String)config.get("port");
    if (portString != null) {
      Mail.port=Integer.valueOf(portString);
    }
    Mail.username=(String)config.get("username");
    Mail.password=(String)config.get("password");
    Mail.from=(String)config.get("from");
    String tlsString=(String)config.get("tls");
    if (StringUtils.isNotBlank(tlsString)) {
      Mail.tls=tlsString.equalsIgnoreCase("true");
    }
    String popBeforeSmtpString=(String)config.get("popbeforesmtp");
    if (StringUtils.isNotBlank(popBeforeSmtpString)) {
      Mail.popBeforeSmtp=popBeforeSmtpString.equalsIgnoreCase("true");
    }
    if (StringUtils.isBlank(hostname) || StringUtils.isBlank(from)) {
      throw new ConfigurationException("mail","Parameters mail:hostname and mail:from are mandatory and must be configured. Please check your openhab.cfg!");
    }
    if (port == null) {
      port=tls ? 587 : 25;
    }
    initialized=true;
  }
}
