{
  broadcaster.getBroadcasterConfig().addFilter(new PerRequestBroadcastFilter(){
    @Override public BroadcastAction filter(    Object originalMessage,    Object message){
      return new BroadcastAction(ACTION.CONTINUE,message);
    }
    @Override public BroadcastAction filter(    AtmosphereResource resource,    Object originalMessage,    Object message){
      HttpServletRequest request=resource.getRequest();
      return new BroadcastAction(ACTION.CONTINUE,getResponseObject(request));
    }
  }
);
  broadcaster.getBroadcasterConfig().addFilter(new PollingDelayFilter());
  broadcaster.getBroadcasterConfig().addFilter(new SendPageUpdateFilter());
  broadcaster.getBroadcasterConfig().addFilter(new DuplicateBroadcastProtectionFilter());
  broadcaster.getBroadcasterConfig().addFilter(new ResponseObjectFilter());
  broadcaster.getBroadcasterConfig().addFilter(new MessageTypeFilter());
  stateChangeListener=new StateChangeListener(){
    public void stateUpdated(    Item item,    State state){
      if (item instanceof GroupItem && !broadcaster.getAtmosphereResources().isEmpty()) {
        broadcaster.broadcast(item);
      }
    }
    public void stateChanged(    final Item item,    State oldState,    State newState){
      if (!broadcaster.getAtmosphereResources().isEmpty()) {
        broadcaster.broadcast(item);
      }
    }
  }
;
  registerStateChangeListenerOnRelevantItems(broadcaster.getID(),stateChangeListener);
}
