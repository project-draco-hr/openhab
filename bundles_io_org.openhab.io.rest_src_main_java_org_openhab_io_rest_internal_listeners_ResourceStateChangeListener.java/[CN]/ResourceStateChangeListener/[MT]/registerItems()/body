{
  StartCacheExecutor();
  BroadcasterConfig config=broadcaster.getBroadcasterConfig();
  configureCache(config);
  addBroadcastFilter(config,new PerRequestBroadcastFilter(){
    @Override public BroadcastAction filter(    String broadcasterId,    Object originalMessage,    Object message){
      return new BroadcastAction(message);
    }
    @Override public BroadcastAction filter(    String broadcasterId,    AtmosphereResource resource,    Object originalMessage,    Object message){
      HttpServletRequest request=null;
      BroadcastAction result=null;
      try {
        request=resource.getRequest();
        Object response=getResponseObject(request);
        result=new BroadcastAction(ACTION.CONTINUE,response);
      }
 catch (      Exception e) {
        result=new BroadcastAction(ACTION.ABORT,getResponseObject(request));
      }
      return result;
    }
  }
);
  addBroadcastFilter(config,new PollingDelayFilter());
  addBroadcastFilter(config,new SendPageUpdateFilter());
  addBroadcastFilter(config,new DuplicateBroadcastProtectionFilter());
  addBroadcastFilter(config,new ResponseObjectFilter());
  stateChangeListener=new StateChangeListener(){
    public void stateUpdated(    Item item,    State state){
    }
    public void stateChanged(    final Item item,    State oldState,    State newState){
      broadcaster.broadcast(item);
    }
  }
;
  registerStateChangeListenerOnRelevantItems(broadcaster.getID(),stateChangeListener);
}
