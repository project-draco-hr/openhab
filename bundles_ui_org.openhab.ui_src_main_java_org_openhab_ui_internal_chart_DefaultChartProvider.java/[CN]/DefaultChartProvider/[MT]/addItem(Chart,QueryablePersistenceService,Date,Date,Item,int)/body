{
  Color color=LINECOLORS[seriesCounter % LINECOLORS.length];
  seriesCounter++;
  String label=null;
  if (itemUIRegistry != null) {
    label=itemUIRegistry.getLabel(item.getName());
    if (label != null && label.contains("[") && label.contains("]")) {
      label=label.substring(0,label.indexOf('['));
    }
  }
  if (label == null)   label=item.getName();
  FilterCriteria filter=new FilterCriteria();
  filter.setBeginDate(timeBegin);
  filter.setEndDate(timeEnd);
  filter.setItemName(item.getName());
  filter.setOrdering(Ordering.ASCENDING);
  Iterable<HistoricItem> result=service.query(filter);
  Iterator<HistoricItem> it=result.iterator();
  Collection<Date> xData=new ArrayList<Date>();
  Collection<Number> yData=new ArrayList<Number>();
  while (it.hasNext()) {
    HistoricItem historicItem=it.next();
    org.openhab.core.types.State state=historicItem.getState();
    if (state instanceof DecimalType) {
      DecimalType value=(DecimalType)state;
      xData.add(historicItem.getTimestamp());
      yData.add(value);
    }
  }
  Series series=chart.addDateSeries(label,xData,yData);
  series.setMarker(SeriesMarker.NONE);
  series.setLineColor(color);
}
