{
  boolean authenticationResult=false;
  try {
    String authHeader=request.getHeader(HTTP_HEADER__AUTHORIZATION);
    if (StringUtils.isBlank(authHeader)) {
      sendAuthenticationHeader(response,realm);
    }
 else {
      authenticationResult=computeAuthHeader(request,authHeader,realm);
      if (!authenticationResult) {
        if (computeRetriesLeft(request) > 0) {
          sendAuthenticationHeader(response,realm);
        }
 else {
          response.sendError(HttpServletResponse.SC_FORBIDDEN);
        }
      }
 else {
        request.getSession().setAttribute(RETRIES_ATTRIBUTE,MAX_RETRIES);
      }
    }
  }
 catch (  IOException ioe) {
    logger.warn("sending response failed",ioe.getLocalizedMessage());
  }
  return authenticationResult;
}
