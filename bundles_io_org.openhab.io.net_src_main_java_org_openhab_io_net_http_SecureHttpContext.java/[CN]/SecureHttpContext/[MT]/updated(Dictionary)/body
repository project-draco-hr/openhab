{
  if (config != null) {
    String securityOptionsString=(String)config.get("option");
    if (StringUtils.isNotBlank(securityOptionsString)) {
      try {
        SecureHttpContext.securityOptions=SecurityOptions.valueOf(securityOptionsString.toUpperCase());
      }
 catch (      IllegalArgumentException iae) {
        logger.warn("couldn't create SecurityOption '{}' - valid values are {}",securityOptionsString,SecurityOptions.values());
        SecureHttpContext.securityOptions=SecurityOptions.OFF;
      }
    }
 else {
      SecureHttpContext.securityOptions=SecurityOptions.OFF;
    }
    String netmaskVal=(String)config.get("netmask");
    ipAddressMatchers.clear();
    if (StringUtils.isNotBlank(netmaskVal)) {
      String[] netmasks=netmaskVal.split(",");
      for (      String netmask : netmasks) {
        ipAddressMatchers.add(new IpAddressMatcher(netmask));
      }
    }
    if (ipAddressMatchers.size() == 0) {
      ipAddressMatchers.add(new IpAddressMatcher("192.168.1.0/24"));
      logger.debug("couldn't find netmask configuration -> using '192.168.1.0/24' instead");
    }
  }
}
